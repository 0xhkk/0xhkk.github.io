---
layout: post
title: "PDA æ·±åº¦è§£æ â€”â€” ç¨‹åºæ²¡æœ‰ç§é’¥ï¼Œæ€ä¹ˆæ§åˆ¶è´¦æˆ·ï¼Ÿ"
---
# PDA æ·±åº¦è§£æ â€”â€” ç¨‹åºæ²¡æœ‰ç§é’¥ï¼Œæ€ä¹ˆæ§åˆ¶è´¦æˆ·ï¼Ÿ

## ä» SPL Token è¯´èµ·

å¦‚æœä½ è¯»è¿‡æˆ‘ä»¬ä¹‹å‰çš„ **SPL Token ç®€æ˜æŒ‡å—**ï¼Œä½ ä¸€å®šè®°å¾—è¿™ä¸ªæ¦‚å¿µï¼š

> æ¯ä¸ªç”¨æˆ·æŒæœ‰çš„æ¯ç§ä»£å¸ï¼Œéƒ½éœ€è¦ä¸€ä¸ª **Token Account** æ¥å­˜æ”¾ã€‚

é‚£é—®é¢˜æ¥äº†ï¼šè¿™ä¸ª Token Account çš„åœ°å€æ˜¯æ€ä¹ˆæ¥çš„ï¼Ÿ

```typescript
// è·å–ç”¨æˆ·çš„ USDC è´¦æˆ·åœ°å€
const userUsdcAccount = getAssociatedTokenAddress(
    usdcMint,      // USDC çš„ Mint åœ°å€
    userWallet     // ç”¨æˆ·é’±åŒ…åœ°å€
);
```

ä½ æœ‰æ²¡æœ‰æƒ³è¿‡ï¼š**è¿™ä¸ªåœ°å€æ˜¯æ€ä¹ˆ"ç®—"å‡ºæ¥çš„ï¼Ÿ**

ç­”æ¡ˆå°±æ˜¯ä»Šå¤©çš„ä¸»è§’ï¼š**PDA (Program Derived Address)**ã€‚

```rust
// ATA åœ°å€çš„æ´¾ç”Ÿè§„åˆ™ï¼ˆä¼ªä»£ç ï¼‰
let ata_address = PDA::derive(
    seeds: [user_wallet, token_program_id, mint],
    program_id: associated_token_program
);
```

æ˜¯çš„ï¼Œä½ ç”¨ `getAssociatedTokenAddress(...)` ç®—å‡ºæ¥çš„è¿™ä¸ªåœ°å€ï¼ˆä¹Ÿå°±æ˜¯ **ATAï¼šAssociated Token Account**ï¼‰ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª **PDA**ï¼

> âš ï¸ å°å¿ƒä¸€ä¸ªå¸¸è§è¯¯è§£ï¼š**å¹¶ä¸æ˜¯æ‰€æœ‰ Token Account éƒ½æ˜¯ PDA**ã€‚
> - **ATA** æ˜¯ *ç”± Associated Token Program æŒ‰å›ºå®š seeds æ´¾ç”Ÿå‡ºæ¥çš„ PDA åœ°å€*ï¼ˆå¯é¢„æµ‹ã€å¯è®¡ç®—ï¼‰ã€‚
> - ä½†ä½ ä¹Ÿå¯ä»¥åˆ›å»ºâ€œæ™®é€š Token Accountâ€ï¼ˆåœ°å€å¯ä»¥æ˜¯éšæœº keypairã€å…¬é’¥åœ¨æ›²çº¿ä¸Šï¼‰ï¼Œå®ƒå°±**ä¸æ˜¯ PDA**ã€‚

---

å¦‚æœä½ ç»§ç»­æ·±å…¥ Solana å¼€å‘ï¼Œä½ ä¼šåœ¨æ›´å¤šåœ°æ–¹é‡åˆ° PDAï¼š

```rust
// Meteora Swap æ± å­åœ°å€
let (pool_address, bump) = Pubkey::find_program_address(
    &[b"pool", token_a.as_ref(), token_b.as_ref()],
    program_id
);
```

åˆçœ‹è¿™äº›ä»£ç ï¼Œå¾ˆå¤šäººçš„å†…å¿ƒæ˜¯å´©æºƒçš„ï¼š
- **Seeds æ˜¯ä»€ä¹ˆï¼Ÿ** ä¸ºä»€ä¹ˆæ˜¯ä¸ªæ•°ç»„ï¼Ÿ
- **Bump æ˜¯ä»€ä¹ˆé¬¼ï¼Ÿ** ä¸ºä»€ä¹ˆè¦è¿”å›ä¸¤ä¸ªå€¼ï¼Ÿ
- **find vs createï¼Ÿ** ä¸ºä»€ä¹ˆæœ‰ä¸¤ä¸ªå‡½æ•°ï¼Ÿ

ä»Šå¤©ï¼Œæˆ‘ä»¬å°±ç»“åˆ **SPL Token** å’Œ **Meteoraï¼ˆçœŸå®çš„ DeFi åè®®ï¼‰** çš„æºç ï¼ŒæŠŠ PDA å½»åº•è®²é€ã€‚

---

## ç¬¬ä¸€å±‚ï¼šå›°å¢ƒ â€”â€” ç§é’¥çš„è¯…å’’

åœ¨ Solana ä¸Šï¼Œ**æ¯ä¸€ç¬”äº¤æ˜“éƒ½éœ€è¦ç­¾å**ã€‚

```
æ™®é€šè´¦æˆ·çš„é€»è¾‘ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç§é’¥ (Secret Key)                       â”‚
â”‚    â”‚                                     â”‚
â”‚    â–¼                                     â”‚
â”‚  å…¬é’¥ (Public Key) â†â”€â”€ è¿™å°±æ˜¯ä½ çš„"åœ°å€"   â”‚
â”‚    â”‚                                     â”‚
â”‚    â–¼                                     â”‚
â”‚  ç­¾å (Signature) â†â”€â”€ è¯æ˜"æˆ‘æ˜¯ä¸»äºº"      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

è¿™å¥—ä½“ç³»å¯¹æ™®é€šç”¨æˆ·æ¥è¯´å®Œç¾æ— ç¼ºã€‚ä½†å¯¹äº **æ™ºèƒ½åˆçº¦ï¼ˆProgramï¼‰** æ¥è¯´ï¼Œé—®é¢˜æ¥äº†ï¼š

> **ç¨‹åºæ˜¯ä¸€æ®µä»£ç ï¼Œå®ƒæ²¡æœ‰ç§é’¥ã€‚**
> 
> é‚£é—®é¢˜æ¥äº†ï¼šSwap æ± å­é‡Œç”¨æˆ·å­˜çš„é’±ï¼Œå½’è°ç®¡ï¼Ÿç¨‹åºæ€ä¹ˆ"ç­¾å"æŠŠé’±è½¬èµ°ï¼Ÿ

### ç­‰ç­‰ï¼ŒEVM çš„åˆçº¦ä¹Ÿæ²¡ç§é’¥å•Šï¼Ÿ

å¦‚æœä½ æœ‰ EVMï¼ˆä»¥å¤ªåŠï¼‰å¼€å‘ç»éªŒï¼Œä½ å¯èƒ½ä¼šé—®ï¼š

> "Uniswap åˆçº¦ä¹Ÿæ²¡æœ‰ç§é’¥ï¼Œå®ƒæ€ä¹ˆç®¡ç†æ± å­é‡Œçš„é’±ï¼Ÿ"

ç­”æ¡ˆæ˜¯ï¼š**EVM å’Œ Solana çš„è´¦æˆ·æ¨¡å‹å®Œå…¨ä¸åŒï¼**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EVM æ¨¡å‹ï¼ˆä»¥å¤ªåŠï¼‰                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚  â”‚  Uniswap åˆçº¦     â”‚  â† åˆçº¦æœ¬èº«å°±æ˜¯ä¸€ä¸ª"è´¦æˆ·"                 â”‚
â”‚  â”‚  åœ°å€: 0x1234... â”‚                                          â”‚
â”‚  â”‚                  â”‚                                          â”‚
â”‚  â”‚  ETHä½™é¢: 1000   â”‚  â† èµ„äº§ç›´æ¥å­˜åœ¨åˆçº¦åœ°å€ä¸‹                  â”‚
â”‚  â”‚  USDCä½™é¢: 5000  â”‚                                          â”‚
â”‚  â”‚                  â”‚                                          â”‚
â”‚  â”‚  [ä»£ç é€»è¾‘]      â”‚  â† ä»£ç æ‰§è¡Œ = æƒé™ï¼Œæ— éœ€ç­¾å               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚                                                                 â”‚
â”‚  ç‰¹ç‚¹ï¼šåˆçº¦ = è´¦æˆ· = èµ„äº§æŒæœ‰è€…                                  â”‚
â”‚        ä»£ç æ‰§è¡Œå°±æ˜¯æƒé™ï¼Œä¸éœ€è¦é¢å¤–çš„"ç­¾å"æœºåˆ¶                   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Solana æ¨¡å‹                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Meteora ç¨‹åº â”‚      â”‚  Pool è´¦æˆ·   â”‚      â”‚  Vault è´¦æˆ·  â”‚    â”‚
â”‚  â”‚ (åªæœ‰ä»£ç )    â”‚      â”‚ (åªæœ‰æ•°æ®)   â”‚      â”‚ (å­˜æ”¾ä»£å¸)   â”‚  â”‚
â”‚  â”‚             â”‚      â”‚              â”‚      â”‚              â”‚   â”‚
â”‚  â”‚ [swapé€»è¾‘]   â”‚      â”‚ ä»·æ ¼ã€æµåŠ¨æ€§  â”‚      â”‚ WSOL: 1000   â”‚     â”‚
â”‚  â”‚ [addé€»è¾‘]    â”‚      â”‚ è´¹ç‡é…ç½®     â”‚      â”‚ USDC: 5000  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                           â”‚           â”‚
â”‚         â”‚        ç¨‹åºæƒ³åŠ¨ Vault çš„é’±ï¼Ÿ              â”‚              â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ éœ€è¦"ç­¾å"ï¼ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                 â”‚
â”‚  ç‰¹ç‚¹ï¼šç¨‹åº â‰  è´¦æˆ·ï¼Œä»£ç å’Œæ•°æ®å®Œå…¨åˆ†ç¦»                                â”‚
â”‚        ä¿®æ”¹ä»»ä½•è´¦æˆ·éƒ½éœ€è¦"æƒé™"ï¼Œæ‰€ä»¥éœ€è¦ PDA                         â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¸€å¥è¯æ€»ç»“ï¼š**

| æ¨¡å‹ | åˆçº¦ä¸èµ„äº§çš„å…³ç³» | è½¬è´¦æƒé™ |
|------|-----------------|---------|
| **EVM** | åˆçº¦åœ°å€ = èµ„äº§åœ°å€ | ä»£ç æ‰§è¡Œå³æƒé™ |
| **Solana** | ç¨‹åº â‰  èµ„äº§è´¦æˆ· | éœ€è¦ç­¾åï¼ˆæ™®é€šè´¦æˆ·ï¼‰æˆ– PDA |

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ Solana éœ€è¦ PDAï¼Œè€Œ EVM ä¸éœ€è¦ â€”â€” **è´¦æˆ·æ¨¡å‹çš„æ ¹æœ¬å·®å¼‚**ã€‚

---

### å›°å¢ƒäºŒï¼šåœ°å€çš„å¯é¢„æµ‹æ€§

é™¤äº†ç­¾åé—®é¢˜ï¼Œè¿˜æœ‰å¦ä¸€ä¸ªå›°å¢ƒï¼š**Token Account çš„åœ°å€æ€ä¹ˆç¡®å®šï¼Ÿ**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EVM æ¨¡å‹                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  USDC åˆçº¦å†…éƒ¨ï¼š                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  mapping(address => uint256) balances;      â”‚               â”‚
â”‚  â”‚                                             â”‚               â”‚
â”‚  â”‚  balances[0xAlice] = 1000                   â”‚               â”‚
â”‚  â”‚  balances[0xBob]   = 500                    â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                 â”‚
â”‚  ç‰¹ç‚¹ï¼šä½™é¢ç›´æ¥å­˜åœ¨åˆçº¦é‡Œï¼Œç”¨ mapping æ˜ å°„                        â”‚
â”‚        Alice çš„åœ°å€å°±æ˜¯ Alice çš„åœ°å€ï¼Œä¸éœ€è¦é¢å¤–åˆ›å»ºè´¦æˆ·          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Solana æ¨¡å‹                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  æ¯ä¸ªç”¨æˆ· Ã— æ¯ç§ä»£å¸ = ä¸€ä¸ªç‹¬ç«‹çš„ Token Account                  â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Alice çš„     â”‚  â”‚ Alice çš„     â”‚  â”‚ Bob çš„       â”‚          â”‚
â”‚  â”‚ USDC è´¦æˆ·    â”‚  â”‚ SOL è´¦æˆ·     â”‚  â”‚ USDC è´¦æˆ·    â”‚          â”‚
â”‚  â”‚ åœ°å€: ???    â”‚  â”‚ åœ°å€: ???    â”‚  â”‚ åœ°å€: ???    â”‚          â”‚
â”‚  â”‚ ä½™é¢: 1000   â”‚  â”‚ ä½™é¢: 50     â”‚  â”‚ ä½™é¢: 500    â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                 â”‚
â”‚  é—®é¢˜ï¼šè¿™äº›è´¦æˆ·çš„åœ°å€æ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆç¡®å®šï¼Ÿ                           â”‚
â”‚        å¦‚æœæ˜¯éšæœºçš„ï¼Œåˆ«äººæ€ä¹ˆçŸ¥é“å¾€å“ªé‡Œè½¬è´¦ï¼Ÿ                     â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é—®é¢˜æ¥äº†ï¼š**

1. **éšæœºç”Ÿæˆåœ°å€ï¼Ÿ** â†’ åˆ«äººä¸çŸ¥é“å¾€å“ªè½¬è´¦
2. **é“¾ä¸ŠæŸ¥è¯¢ï¼Ÿ** â†’ å¤ªæ…¢ï¼Œè€Œä¸”å¯èƒ½è¿˜æ²¡åˆ›å»º
3. **ç”¨æˆ·è‡ªå·±è®°ä½ï¼Ÿ** â†’ å¤ªéº»çƒ¦ï¼Œå®¹æ˜“å‡ºé”™

**è§£å†³æ–¹æ¡ˆï¼šPDAï¼**

```rust
// ç”¨ç¡®å®šæ€§çš„æ–¹å¼"ç®—å‡º"åœ°å€
let alice_usdc_account = PDA::derive(
    seeds: [alice_wallet, token_program, usdc_mint],
    program_id: associated_token_program
);

// ä»»ä½•äººéƒ½èƒ½ç®—å‡º Alice çš„ USDC è´¦æˆ·åœ°å€ï¼
// ä¸éœ€è¦é“¾ä¸ŠæŸ¥è¯¢ï¼Œä¸éœ€è¦ Alice å‘Šè¯‰ä½ 
```

---

**æ€»ç»“ï¼šPDA è§£å†³çš„ä¸¤å¤§å›°å¢ƒ**

| å›°å¢ƒ | é—®é¢˜ | PDA å¦‚ä½•è§£å†³ |
|------|------|-------------|
| **ç­¾åå›°å¢ƒ** | ç¨‹åºæ²¡æœ‰ç§é’¥ï¼Œæ€ä¹ˆæ§åˆ¶èµ„é‡‘ï¼Ÿ | PDA å¯ä»¥"ç­¾å"ï¼ˆinvoke_signedï¼‰ |
| **åœ°å€å›°å¢ƒ** | Token Account åœ°å€æ€ä¹ˆç¡®å®šï¼Ÿ | PDA åœ°å€å¯é¢„æµ‹ã€å¯è®¡ç®— |

---

## ç¬¬äºŒå±‚ï¼šè§£å†³æ–¹æ¡ˆ â€”â€” PDA æ¨ªç©ºå‡ºä¸–

Solana çš„è§£å†³æ–¹æ¡ˆéå¸¸å·§å¦™ï¼š**åˆ›é€ ä¸€ç§æ²¡æœ‰ç§é’¥çš„åœ°å€**ã€‚

### ä»€ä¹ˆæ˜¯ PDAï¼Ÿ

PDA = **Program Derived Addressï¼ˆç¨‹åºæ´¾ç”Ÿåœ°å€ï¼‰**

å®ƒæœ‰ä¸¤ä¸ªæ ¸å¿ƒç‰¹ç‚¹ï¼š

1. **ç”±ç¨‹åº"æ´¾ç”Ÿ"å‡ºæ¥**ï¼šé€šè¿‡ `program_id` + `seeds` è®¡ç®—å¾—åˆ°
2. **æ²¡æœ‰å¯¹åº”çš„ç§é’¥**ï¼šå®ƒåœ¨æ¤­åœ†æ›²çº¿çš„"å¤–é¢"ï¼ˆOff-curveï¼‰

```
æ™®é€šåœ°å€ vs PDAï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ¤­åœ†æ›²çº¿                            â”‚
â”‚                                                       â”‚
â”‚    â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹           â”‚
â”‚   â—‹                                     â—‹            â”‚
â”‚  â—‹   æ™®é€šåœ°å€éƒ½åœ¨è¿™æ¡æ›²çº¿ä¸Š              â—‹           â”‚
â”‚  â—‹   ï¼ˆæœ‰å¯¹åº”ç§é’¥ï¼‰                       â—‹           â”‚
â”‚   â—‹                                     â—‹            â”‚
â”‚    â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹           â”‚
â”‚                                                       â”‚
â”‚                           â˜… PDA åœ¨è¿™é‡Œï¼              â”‚
â”‚                          ï¼ˆæ›²çº¿å¤–ï¼Œæ— ç§é’¥ï¼‰            â”‚
â”‚                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¯”å–»ï¼šç¨‹åºä¸“å±çš„"å°ç« "

æƒ³è±¡ä½ å¼€äº†ä¸€å®¶é“¶è¡Œï¼ˆç¨‹åºï¼‰ã€‚é“¶è¡Œéœ€è¦ä¸€ä¸ªé‡‘åº“ï¼ˆè´¦æˆ·ï¼‰æ¥å­˜é’±ã€‚

- **æ™®é€šæ–¹æ¡ˆ**ï¼šç»™é‡‘åº“é…ä¸€æŠŠé’¥åŒ™ï¼ˆç§é’¥ï¼‰ã€‚ä½†é’¥åŒ™å¯èƒ½ä¸¢ã€å¯èƒ½è¢«å·ã€‚
- **PDA æ–¹æ¡ˆ**ï¼šé‡‘åº“ç”¨ **é“¶è¡Œçš„å°ç« ** æ¥æ§åˆ¶ã€‚åªæœ‰é“¶è¡Œæœ¬èº«ï¼ˆç¨‹åºï¼‰èƒ½ç›–ç« ï¼Œæ²¡æœ‰"é’¥åŒ™"è¿™ä¸ªä¸œè¥¿ã€‚

```
PDA çš„"å°ç« "é€»è¾‘ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Meteora ç¨‹åº (Program ID)            â”‚
â”‚       +                              â”‚
â”‚  Seeds: ["pool", token_a, token_b]   â”‚
â”‚       â†“                              â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚       â†“                              â”‚
â”‚  PDA åœ°å€: HLnpSz9h2S4hi...          â”‚
â”‚  ï¼ˆè¿™ä¸ªåœ°å€åªæœ‰ Meteora èƒ½"ç­¾å"ï¼‰     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç¬¬ä¸‰å±‚ï¼šPDA æºä»£ç æ­ç§˜ â€”â€” find_program_address æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ

ç†è§£äº† PDA çš„æ¦‚å¿µï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å®ƒæ˜¯æ€ä¹ˆ"ç®—"å‡ºæ¥çš„ï¼š

```rust
// æ¥è‡ª Solana SDK: solana_program/src/pubkey.rs (ç®€åŒ–ç‰ˆ)

pub fn find_program_address(seeds: &[&[u8]], program_id: &Pubkey) -> (Pubkey, u8) {
    // ä» 255 å¼€å§‹ï¼Œé€’å‡æŸ¥æ‰¾
    let mut bump_seed = [u8::MAX];  // 255
    
    loop {
        // æŠŠ bump åŠ åˆ° seeds æœ«å°¾
        let seeds_with_bump: Vec<&[u8]> = seeds
            .iter()
            .chain(std::iter::once(&bump_seed[..]))
            .collect();
        
        // å°è¯•åˆ›å»º PDA
        match Self::create_program_address(&seeds_with_bump, program_id) {
            Ok(address) => {
                // æˆåŠŸï¼è¿™ä¸ªåœ°å€åœ¨æ›²çº¿å¤–
                return (address, bump_seed[0]);
            }
            Err(_) => {
                // å¤±è´¥ï¼Œè¿™ä¸ªåœ°å€åœ¨æ›²çº¿ä¸Šï¼ˆæœ‰å¯¹åº”ç§é’¥ï¼‰
                // ç»§ç»­å°è¯•ä¸‹ä¸€ä¸ª bumpï¼ˆæ³¨æ„ï¼šbump=0 ä¹Ÿæ˜¯å¯èƒ½çš„ï¼Œéœ€è¦å°è¯•åˆ° 0 ä¸ºæ­¢ï¼‰
                if bump_seed[0] == 0 {
                    panic!("Unable to find a valid PDA");
                }
                bump_seed[0] -= 1;
            }
        }
    }
}

pub fn create_program_address(seeds: &[&[u8]], program_id: &Pubkey) -> Result<Pubkey, PubkeyError> {
    // 1. æŠŠæ‰€æœ‰ seeds è¿æ¥èµ·æ¥
    // hasher å¯¹è±¡å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªä¸´æ—¶çŠ¶æ€ã€‚
    // å½“ä½ è°ƒç”¨ hasher.hash(A) æ—¶ï¼Œå®ƒæŠŠ A å¤„ç†è¿›çŠ¶æ€é‡Œã€‚
    // å½“ä½ è°ƒç”¨ hasher.hash(B) æ—¶ï¼Œå®ƒæŠŠ B æ¥åœ¨ A åé¢å¤„ç†è¿›çŠ¶æ€é‡Œã€‚
    // æœ€åè°ƒç”¨ hasher.result() æ—¶ï¼Œå®ƒæŠŠæœ€ç»ˆçš„â€œæœæ±â€ï¼ˆ32å­—èŠ‚å“ˆå¸Œå€¼ï¼‰å€’å‡ºæ¥ã€‚
    let mut hasher = Hasher::default();
    for seed in seeds {
        hasher.hash(seed);
    }
    hasher.hash(program_id.as_ref());
    hasher.hash(b"ProgramDerivedAddress");  // ç‰¹æ®Šåç¼€
    
    // 2. è®¡ç®— SHA256 å“ˆå¸Œ
    let hash = hasher.result();
    
    // 3. æŠŠå“ˆå¸Œè½¬æˆå…¬é’¥æ ¼å¼
    let pubkey = Pubkey::new_from_array(hash);
    
    // 4. æ£€æŸ¥æ˜¯å¦åœ¨æ¤­åœ†æ›²çº¿ä¸Š
    if pubkey.is_on_curve() {
        return Err(PubkeyError::InvalidSeeds);  // æœ‰ç§é’¥ï¼Œä¸èƒ½ç”¨ï¼
    }
    
    Ok(pubkey)
}
```


**æ ¸å¿ƒæµç¨‹ï¼š**

```
                    find_program_address(seeds, program_id)
                                    â”‚
                                    â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  bump = 255                   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  hash = SHA256(               â”‚
                    â”‚    seeds + [bump] +           â”‚
                    â”‚    program_id +               â”‚
                    â”‚    "ProgramDerivedAddress"    â”‚
                    â”‚  )                            â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  hash åœ¨æ¤­åœ†æ›²çº¿ä¸Šï¼Ÿ          â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            æ˜¯ â”‚           â”‚ å¦
                               â–¼           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ bump -= 1   â”‚  â”‚ è¿”å› (hash,  â”‚
                    â”‚ ç»§ç»­å¾ªç¯    â”‚  â”‚        bump) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç¬¬å››å±‚ï¼šBump çš„çœŸç›¸ â€”â€” åœ¨åœ°å›¾ä¸Šæ‰¾"æ— äººåŒº"

ç°åœ¨æ¥è§£å†³é‚£ä¸ªè®©äººå›°æƒ‘çš„ `bump`ã€‚

### ä¸ºä»€ä¹ˆéœ€è¦ Bumpï¼Ÿ

å›å¿†ä¸€ä¸‹ï¼šPDA å¿…é¡»åœ¨æ¤­åœ†æ›²çº¿çš„ **å¤–é¢**ï¼ˆæ²¡æœ‰å¯¹åº”ç§é’¥ï¼‰ã€‚

ä½†é—®é¢˜æ˜¯ï¼šå½“ä½ ç”¨ `seeds + program_id` è®¡ç®—åœ°å€æ—¶ï¼Œç»“æœå¯èƒ½æ°å¥½è½åœ¨æ›²çº¿ **ä¸Š**ï¼

```
ç¬¬ä¸€æ¬¡å°è¯•ï¼š
hash(seeds + program_id + 255) â†’ 0x1234...ï¼ˆåœ¨æ›²çº¿ä¸Šï¼æœ‰ç§é’¥ï¼ï¼‰âŒ

ç¬¬äºŒæ¬¡å°è¯•ï¼š
hash(seeds + program_id + 254) â†’ 0x5678...ï¼ˆåœ¨æ›²çº¿ä¸Šï¼æœ‰ç§é’¥ï¼ï¼‰âŒ

ç¬¬ä¸‰æ¬¡å°è¯•ï¼š
hash(seeds + program_id + 253) â†’ 0x9ABC...ï¼ˆæ›²çº¿å¤–ï¼æ²¡ç§é’¥ï¼ï¼‰âœ…
                          â†‘
                      è¿™ä¸ª 253 å°±æ˜¯ Bumpï¼
```

### æ¯”å–»ï¼šæ‰¾åœè½¦ä½

æƒ³è±¡ä½ åœ¨ä¸€ä¸ªå·¨å¤§çš„åœè½¦åœºæ‰¾è½¦ä½ï¼š

```
åœè½¦åœºï¼ˆæ¤­åœ†æ›²çº¿ï¼‰ï¼š

    [å ] [å ] [å ] [å ] [å ] [å ] [å ] [ç©º] [å ] [å ]
     255  254  253  252  251  250  249  248  247  246
                                         â†‘
                                    Bump = 248
                                    
ä» 255 å¼€å§‹æ‰¾ï¼Œä¸€ç›´æ‰¾åˆ°ç¬¬ä¸€ä¸ªç©ºä½ã€‚
é‚£ä¸ªç©ºä½çš„ç¼–å·å°±æ˜¯ Bumpã€‚
```

### find vs create

```rust
// æ–¹æ³• 1ï¼šfind_program_addressï¼ˆæ‰¾ Bumpï¼‰
// è´¹ç®—åŠ›ï¼Œå› ä¸ºè¦ä» 255 å¼€å§‹ä¸€ä¸ªä¸ªè¯•
let (pda, bump) = Pubkey::find_program_address(
    &[b"pool", mint_a.as_ref(), mint_b.as_ref()],
    program_id
);
// é€‚åˆï¼šé“¾ä¸‹ï¼ˆå‰ç«¯/å®¢æˆ·ç«¯ï¼‰ä½¿ç”¨

// æ–¹æ³• 2ï¼šcreate_program_addressï¼ˆç›´æ¥ç”¨ Bumpï¼‰
// çœç®—åŠ›ï¼Œå› ä¸ºç›´æ¥éªŒè¯
let pda = Pubkey::create_program_address(
    &[b"pool", mint_a.as_ref(), mint_b.as_ref(), &[bump]],
    program_id
)?;
// é€‚åˆï¼šé“¾ä¸Šï¼ˆåˆçº¦ï¼‰ä½¿ç”¨ï¼Œå‰ææ˜¯å·²ç»çŸ¥é“ bump
```

---

## ç¬¬äº”å±‚ï¼šSeeds è®¾è®¡å“²å­¦ â€”â€” ä» ATA åˆ° Meteora å®æˆ˜

ç†è§£äº† PDA çš„åŸç†ï¼Œç°åœ¨æ¥çœ‹å®é™…é¡¹ç›®æ˜¯æ€ä¹ˆè®¾è®¡ Seeds çš„ã€‚

### 5.1 çƒ­èº«ï¼šATA çš„ Seeds è®¾è®¡

å…ˆå›åˆ°æˆ‘ä»¬ç†Ÿæ‚‰çš„ **Associated Token Account (ATA)**ï¼š

```rust
// ATA çš„ Seeds è®¾è®¡
let (ata_address, bump) = Pubkey::find_program_address(
    &[
        wallet.as_ref(),           // è°çš„è´¦æˆ·
        token_program.as_ref(),    // Token ç¨‹åº ID
        mint.as_ref(),             // ä»€ä¹ˆä»£å¸
    ],
    &associated_token_program_id
);
```

**ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ**

```
ATA çš„æ ¸å¿ƒéœ€æ±‚ï¼š
"ç»™å®šä¸€ä¸ªé’±åŒ… + ä¸€ç§ä»£å¸ï¼Œæˆ‘èƒ½å”¯ä¸€ç¡®å®šå®ƒçš„ Token Account åœ°å€"

Seeds è®¾è®¡ï¼š[wallet, token_program, mint]
           â”‚         â”‚             â”‚
           â”‚         â”‚             â””â”€â”€ å“ªç§ä»£å¸ï¼ˆUSDC? WSOL?ï¼‰
           â”‚         â””â”€â”€ ç”¨å“ªä¸ªTokenç¨‹åºï¼ˆToken / Token-2022ï¼‰
           â””â”€â”€ è°çš„è´¦æˆ·

â†’ ç»“æœï¼šä»»ä½•äººéƒ½èƒ½"ç®—å‡º"ä½ çš„ USDC è´¦æˆ·åœ°å€ï¼Œæ— éœ€é“¾ä¸ŠæŸ¥è¯¢
```

è¿™å°±æ˜¯ PDA Seeds è®¾è®¡çš„ç²¾é«“ï¼š**è®©åœ°å€å¯é¢„æµ‹ã€å¯è®¡ç®—ã€å”¯ä¸€ç¡®å®š**ã€‚

### 5.2 Meteora: Pool Authorityï¼ˆæ± å­æƒå¨ï¼‰

```rust
// æ¥è‡ª Meteora: const_pda.rs
pub mod pool_authority {
    //derive_program_address åœ¨â€œç¼–è¯‘æœŸâ€åšäº†ç±»ä¼¼ find_program_address çš„æ´¾ç”Ÿï¼ˆåŒ…å«æœç´¢ bumpï¼‰ï¼Œ
    //æ•ˆæœä¸Šç­‰ä»·äºæŠŠ (PDA, bump) é¢„å…ˆç®—å¥½å¹¶å›ºåŒ–åˆ°ç¨‹åºé‡Œ
    const POOL_AUTHORITY_AND_BUMP: ([u8; 32], u8) = ed25519::derive_program_address(
        &[crate::constants::seeds::POOL_AUTHORITY_PREFIX],  // seeds: ["pool_authority"]
        &crate::ID_CONST.to_bytes(),                        // program_id
    );

    pub const ID: Pubkey = Pubkey::new_from_array(POOL_AUTHORITY_AND_BUMP.0);
    pub const BUMP: u8 = POOL_AUTHORITY_AND_BUMP.1;
}
```

è¿™é‡Œçš„ `POOL_AUTHORITY_PREFIX` å®šä¹‰åœ¨ constants.rsï¼š

```rust
// æ¥è‡ª Meteora: constants.rs
pub mod seeds {
    pub const POOL_AUTHORITY_PREFIX: &[u8] = b"pool_authority";
    pub const POOL_PREFIX: &[u8] = b"pool";
    pub const TOKEN_VAULT_PREFIX: &[u8] = b"token_vault";
    pub const POSITION_PREFIX: &[u8] = b"position";
    // ...
}
```

**ä¸ºä»€ä¹ˆ Seed åªæœ‰ä¸€ä¸ª `"pool_authority"`ï¼Ÿ**

å› ä¸º Meteora çš„è®¾è®¡æ˜¯ï¼š**æ•´ä¸ªç¨‹åºå…±ç”¨ä¸€ä¸ª Authority**ã€‚æ‰€æœ‰æ± å­çš„é’±éƒ½ç”±è¿™ä¸€ä¸ª PDA æ¥ç®¡ç†ã€‚

```
Meteora çš„ Pool Authority è®¾è®¡ï¼š

     Pool Authority (PDA)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Seeds: ["pool_      â”‚
    â”‚         authority"] â”‚
    â”‚                     â”‚
    â”‚  ç®¡ç†æ‰€æœ‰æ± å­çš„é’±    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼         â–¼         â–¼
  Pool A    Pool B    Pool C
  Vault     Vault     Vault
```

**Meteora çš„ç¼–è¯‘æ—¶ä¼˜åŒ–ï¼š**

```rust
// æ¥è‡ª Meteora: const_pda.rs
// ç¼–è¯‘æ—¶å°±ç®—å¥½ PDA å’Œ Bumpï¼
const POOL_AUTHORITY_AND_BUMP: ([u8; 32], u8) = ed25519::derive_program_address(
    &[POOL_AUTHORITY_PREFIX],
    &crate::ID_CONST.to_bytes(),
);

pub const ID: Pubkey = ...;
pub const BUMP: u8 = POOL_AUTHORITY_AND_BUMP.1;  // ç¼–è¯‘æ—¶å¸¸é‡ï¼
```

**ç­‰ç­‰ï¼Œ`const` æ˜¯ç¼–è¯‘æ—¶è¿˜æ˜¯è¿è¡Œæ—¶ï¼Ÿ**

è¿™æ˜¯ä¸ªå…³é”®é—®é¢˜ï¼ç­”æ¡ˆæ˜¯ï¼š**ç¼–è¯‘æ—¶ï¼**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ—¶é—´çº¿                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. ç¼–è¯‘æ—¶ï¼ˆcargo build-sbfï¼‰                                    â”‚
â”‚     â”‚                                                           â”‚
â”‚     â”œâ”€â”€ ed25519::derive_program_address() åœ¨è¿™é‡Œè¿è¡Œï¼          â”‚
â”‚     â”œâ”€â”€ è®¡ç®—å‡º PDA åœ°å€: HLnpSz9h2S4hi...                       â”‚
â”‚     â”œâ”€â”€ è®¡ç®—å‡º Bump: 253                                        â”‚
â”‚     â””â”€â”€ ç»“æœè¢«"çƒ§å½•"åˆ°ç¼–è¯‘åçš„ .so æ–‡ä»¶é‡Œ                        â”‚
â”‚                                                                 â”‚
â”‚  2. éƒ¨ç½²æ—¶ï¼ˆsolana program deployï¼‰                              â”‚
â”‚     â”‚                                                           â”‚
â”‚     â””â”€â”€ ä¸Šä¼  .so æ–‡ä»¶ï¼ŒPDA åœ°å€å·²ç»ç¡®å®šäº†                        â”‚
â”‚                                                                 â”‚
â”‚  3. è¿è¡Œæ—¶ï¼ˆç”¨æˆ·è°ƒç”¨ Swapï¼‰                                      â”‚
â”‚     â”‚                                                           â”‚
â”‚     â””â”€â”€ ç›´æ¥ç”¨ç¼–è¯‘å¥½çš„å¸¸é‡ï¼Œä¸éœ€è¦å†ç®—ï¼                         â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®ï¼šconst fnï¼ˆå¸¸é‡å‡½æ•°ï¼‰**

`ed25519::derive_program_address` æ¥è‡ª `const_crypto` crateï¼Œå®ƒæ˜¯ä¸€ä¸ª `const fn`ï¼š

```rust
// const fn = å¯ä»¥åœ¨ç¼–è¯‘æ—¶è¿è¡Œçš„å‡½æ•°
pub const fn derive_program_address(
    seeds: &[&[u8]], 
    program_id: &[u8; 32]
) -> ([u8; 32], u8) {
    // ç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘æ—¶æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼
}
```

**å¯¹æ¯”ï¼šç¼–è¯‘æ—¶ vs è¿è¡Œæ—¶**

```rust
// âŒ è¿è¡Œæ—¶è®¡ç®—ï¼ˆæ ‡å‡†åº“ï¼‰
// æ¯æ¬¡è°ƒç”¨éƒ½è¦ä» 255 å¼€å§‹æ‰¾ bumpï¼Œè´¹è®¡ç®—å•å…ƒï¼ˆCompute Units, CUï¼‰
let (pda, bump) = Pubkey::find_program_address(
    &[b"pool_authority"],
    program_id
);

// âœ… ç¼–è¯‘æ—¶è®¡ç®—ï¼ˆconst_cryptoï¼‰
// ç¼–è¯‘å™¨å¸®ä½ ç®—å¥½ï¼Œè¿è¡Œæ—¶ç›´æ¥ç”¨ï¼Œé›¶æˆæœ¬
const PDA_AND_BUMP: ([u8; 32], u8) = ed25519::derive_program_address(
    &[b"pool_authority"],
    &PROGRAM_ID,
);
```

| æ–¹å¼ | è®¡ç®—æ—¶æœº | CU æ¶ˆè€— | å®‰å…¨æ€§ |
|------|---------|---------|--------|
| **è¿è¡Œæ—¶** `find_program_address` | æ¯æ¬¡è°ƒç”¨éƒ½ç®— | é«˜ | å¯èƒ½å‡ºé”™ï¼ˆä¾‹å¦‚ seeds è®¾è®¡é”™è¯¯/æ’åºä¸ä¸€è‡´ç­‰ï¼‰ |
| **ç¼–è¯‘æ—¶** `const fn` | ç¼–è¯‘æ—¶ç®—ä¸€æ¬¡ | é›¶ | ç¼–è¯‘æ—¶éªŒè¯ |

```rust
// æ¥è‡ª Meteora: macros.rs 
macro_rules! pool_authority_seeds {
    () => {
        &[
            crate::constants::seeds::POOL_AUTHORITY_PREFIX,
            &[crate::const_pda::pool_authority::BUMP],  // ç›´æ¥ç”¨å¸¸é‡ Bump
        ]
    };
}
```

**æ€»ç»“ï¼šMeteora çš„ä¼˜åŒ–å¥½å¤„**
- âœ… **çœ CU**ï¼šé“¾ä¸Šä¸éœ€è¦å†ç®— Bumpï¼Œç¼–è¯‘æ—¶å·²ç¡®å®š
- âœ… **å®‰å…¨**ï¼šBump æ˜¯ç¼–è¯‘æ—¶ç¡®å®šçš„ï¼Œä¸ä¼šå‡ºé”™
- âœ… **ç®€æ´**ï¼šç”¨å®å°è£…ï¼Œè°ƒç”¨æ—¶ä¸€è¡Œæå®š

### 5.3 Meteora: Pool åœ°å€ï¼ˆæ± å­åœ°å€ï¼‰

```rust
// æ¥è‡ª Meteora: ix_initialize_pool.rs
#[account(
    init,
    seeds = [
        POOL_PREFIX.as_ref(),                              // "pool"
        config.key().as_ref(),                             // é…ç½®è´¦æˆ·
        &max_key(&token_a_mint.key(), &token_b_mint.key()), // è¾ƒå¤§çš„ mint
        &min_key(&token_a_mint.key(), &token_b_mint.key()), // è¾ƒå°çš„ mint
    ],
    bump,
    payer = payer,
    space = 8 + Pool::INIT_SPACE
)]
pub pool: AccountLoader<'info, Pool>,
```

**ä¸ºä»€ä¹ˆè¦ max/min æ’åºï¼Ÿ**

è¿™æ˜¯ä¸ªå¾ˆèªæ˜çš„è®¾è®¡ï¼

```rust
// å‡è®¾ï¼š
// token_a = "USDC" (åœ°å€: EPjFWdd5...)
// token_b = "SOL"  (åœ°å€: So11111...)

// å¦‚æœä¸æ’åºï¼Œä¼šäº§ç”Ÿä¸¤ä¸ªä¸åŒçš„æ± å­åœ°å€ï¼š
// seeds: ["pool", config, USDC, SOL]  â†’ æ± å­ A
// seeds: ["pool", config, SOL, USDC]  â†’ æ± å­ B  â† åŒä¸€ä¸ªäº¤æ˜“å¯¹ï¼Œä¸¤ä¸ªæ± å­ï¼

// ç”¨ max/min æ’åºåï¼š
// seeds: ["pool", config, max(USDC,SOL), min(USDC,SOL)]  â†’ æ°¸è¿œåŒä¸€ä¸ªæ± å­ï¼
```

è¿™ä¿è¯äº† **åŒä¸€ä¸ªäº¤æ˜“å¯¹åªæœ‰å”¯ä¸€çš„æ± å­åœ°å€**ã€‚

### 5.4 Meteora: Token Vaultï¼ˆä»£å¸é‡‘åº“ï¼‰

```rust
// æ¥è‡ª Meteora: ix_initialize_pool.rs
#[account(
    init,
    seeds = [
        TOKEN_VAULT_PREFIX.as_ref(),   // "token_vault"
        token_a_mint.key().as_ref(),    // å“ªä¸ªä»£å¸
        pool.key().as_ref(),            // å±äºå“ªä¸ªæ± å­
    ],
    token::mint = token_a_mint,
    token::authority = pool_authority,  // ç”± pool_authority PDA æ§åˆ¶ï¼
    token::token_program = token_a_program,
    payer = payer,
    bump,
)]
pub token_a_vault: Box<InterfaceAccount<'info, TokenAccount>>,
```

**Seeds è®¾è®¡é€»è¾‘ï¼š**

```
Token Vault çš„ Seeds è®¾è®¡ï¼š

Seeds: ["token_vault", token_mint, pool]
         â”‚              â”‚          â”‚
         â”‚              â”‚          â””â”€â”€ å±äºå“ªä¸ªæ± å­ï¼ˆå”¯ä¸€æ€§ï¼‰
         â”‚              â””â”€â”€ å­˜çš„æ˜¯ä»€ä¹ˆä»£å¸
         â””â”€â”€ æ ‡è¯†è¿™æ˜¯ä¸ªé‡‘åº“è´¦æˆ·

â†’ ç»“æœï¼šæ¯ä¸ªæ± å­çš„æ¯ç§ä»£å¸éƒ½æœ‰å”¯ä¸€çš„é‡‘åº“åœ°å€
```

**ä¸€ä¸ª Pool = ä¸¤ä¸ª Vault**

```rust
// æ¥è‡ª Meteora: state/pool.rs
pub struct Pool {
    // ...
    pub token_a_vault: Pubkey,  // Token A çš„é‡‘åº“
    pub token_b_vault: Pubkey,  // Token B çš„é‡‘åº“
    // ...
}
```

```
Pool (WSOL-USDC):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pool è´¦æˆ·                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ token_a_mint: WSOL                          â”‚   â”‚
â”‚  â”‚ token_b_mint: USDC                          â”‚   â”‚
â”‚  â”‚ token_a_vault: â†’ Vault A (PDA)              â”‚   â”‚
â”‚  â”‚ token_b_vault: â†’ Vault B (PDA)              â”‚   â”‚
â”‚  â”‚ liquidity: 1000000                          â”‚   â”‚
â”‚  â”‚ sqrt_price: ...                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Vault A (PDA)   â”‚         â”‚ Vault B (PDA)   â”‚
â”‚                 â”‚         â”‚                 â”‚
â”‚ mint: WSOL      â”‚         â”‚ mint: USDC      â”‚
â”‚ owner: pool_authâ”‚         â”‚ owner: pool_authâ”‚
â”‚ amount: 1000    â”‚         â”‚ amount: 5000    â”‚
â”‚                 â”‚         â”‚                 â”‚
â”‚ seeds:          â”‚         â”‚ seeds:          â”‚
â”‚ [token_vault,   â”‚         â”‚ [token_vault,   â”‚
â”‚  WSOL, Pool]    â”‚         â”‚  USDC, Pool]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.5 å˜æ¸…å…³ç³»ï¼šPool vs Pool Authority vs Vault

è¿™ä¸‰è€…çš„å…³ç³»å®¹æ˜“è®©äººå›°æƒ‘ï¼Œè®©æˆ‘ä»¬å½»åº•ç†æ¸…ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                     â”‚
â”‚  Pool Authority (PDA)                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚ Seeds: ["pool_authority"]       â”‚ â† å…¨å±€å”¯ä¸€ï¼Œæ•´ä¸ªç¨‹åºå°±ä¸€ä¸ª      â”‚
â”‚  â”‚                                 â”‚                               â”‚
â”‚  â”‚ æ²¡æœ‰å­˜æ•°æ®ï¼                    â”‚ â† åªæ˜¯ä¸€ä¸ª"ç­¾åè€…èº«ä»½"          â”‚
â”‚  â”‚ å®ƒçš„ä½œç”¨å°±æ˜¯"ç­¾å"              â”‚                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                    â”‚                                                â”‚
â”‚                    â”‚ ownerï¼ˆauthorityï¼‰                             â”‚
â”‚                    â–¼                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚ Vault (Token Account)           â”‚                               â”‚
â”‚  â”‚                                 â”‚                               â”‚
â”‚  â”‚ Seeds: ["token_vault", mint, pool] â† seeds é‡Œæœ‰ pool            â”‚
â”‚  â”‚ owner: pool_authority           â”‚ â† ä½† owner æ˜¯ pool_authority  â”‚
â”‚  â”‚ amount: 1000                    â”‚                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚ Pool (æ•°æ®è´¦æˆ·)                  â”‚                               â”‚
â”‚  â”‚                                 â”‚                               â”‚
â”‚  â”‚ Seeds: ["pool", config, ...]    â”‚                               â”‚
â”‚  â”‚ å­˜å‚¨ï¼šä»·æ ¼ã€æµåŠ¨æ€§ã€è´¹ç‡...      â”‚ â† åªæ˜¯é…ç½®æ•°æ®ï¼Œä¸æ§åˆ¶èµ„é‡‘      â”‚
â”‚  â”‚                                 â”‚                               â”‚
â”‚  â”‚ token_a_vault: Vault A çš„åœ°å€   â”‚ â† åªæ˜¯è®°å½•äº† Vault çš„åœ°å€       â”‚
â”‚  â”‚ token_b_vault: Vault B çš„åœ°å€   â”‚                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¸‰è€…çš„èŒè´£ï¼š**

| è´¦æˆ· | ä½œç”¨ | Seeds | å…³é”®ç‚¹ |
|------|------|-------|--------|
| **Pool Authority** | ç­¾åè€…èº«ä»½ | `["pool_authority"]` | æ˜¯æ‰€æœ‰ Vault çš„ ownerï¼Œèƒ½"ç­¾å"è½¬è´¦ |
| **Pool** | å­˜é…ç½®æ•°æ® | `["pool", config, tokens...]` | åªå­˜æ•°æ®ï¼Œä¸æ§åˆ¶èµ„é‡‘ |
| **Vault** | å­˜ä»£å¸ | `["token_vault", mint, pool]` | owner=pool_authority, seedså«pool |

**Vault çš„ä¸¤ä¸ª"å…³ç³»"ï¼š**

```
1. owner = pool_authority
   â†’ å†³å®š"è°èƒ½åŠ¨è¿™ä¸ªè´¦æˆ·çš„é’±"
   â†’ åªæœ‰ pool_authority èƒ½ç­¾åè½¬è´¦

2. seeds = ["token_vault", mint, pool]
   â†’ å†³å®š"è¿™ä¸ª Vault çš„åœ°å€æ€ä¹ˆç®—"
   â†’ pool åœ¨ seeds é‡Œæ˜¯ä¸ºäº†å”¯ä¸€æ€§å’Œå¯é¢„æµ‹æ€§
   â†’ è®©ä»»ä½•äººéƒ½èƒ½ç®—å‡ºæŸä¸ª Pool çš„ Vault åœ°å€
```

**ä¸€å¥è¯æ€»ç»“ï¼š**

> Pool å’Œ Pool Authority æ²¡æœ‰ç›´æ¥å…³ç³»ï¼
> - Pool åªç®¡æ•°æ®ï¼ˆé…ç½®ï¼‰
> - Pool Authority åªç®¡ç­¾åï¼ˆæ§åˆ¶èµ„é‡‘ï¼‰
> - å®ƒä»¬é€šè¿‡ Vault é—´æ¥å…³è”ï¼šVault çš„ seeds å« poolï¼Œä½† owner æ˜¯ pool_authority

---

## ç¬¬å…­å±‚ï¼šå®æˆ˜ç†è§£ â€”â€” PDA åœ¨ Swap ä¸­çš„è§’è‰²

ç°åœ¨æŠŠæ‰€æœ‰çŸ¥è¯†ä¸²èµ·æ¥ï¼Œçœ‹çœ‹ PDA åœ¨ Meteora Swap ä¸­æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼š

```
ç”¨æˆ· Swapï¼šç”¨ 100 USDC æ¢ SOL

1. ç”¨æˆ·è°ƒç”¨ Swap æŒ‡ä»¤
   â”‚
   â–¼
2. ç¨‹åºéªŒè¯ Pool åœ°å€ï¼ˆPDAï¼‰
   seeds: ["pool", config, max(USDC,SOL), min(USDC,SOL)]
   â”‚
   â–¼
3. ç¨‹åºéªŒè¯ Token Vault åœ°å€ï¼ˆPDAï¼‰
   seeds: ["token_vault", USDC, pool]
   seeds: ["token_vault", SOL, pool]
   â”‚
   â–¼
4. ç”¨æˆ·çš„ 100 USDC è½¬å…¥ USDC Vault
   ï¼ˆç”¨æˆ·ç­¾åï¼‰
   â”‚
   â–¼
5. WSOL Vault è½¬å‡º WSOL ç»™ç”¨æˆ·
   â“ è°æ¥ç­¾åï¼Ÿ
   â”‚
   â–¼
6. Pool Authority (PDA) ç­¾åï¼
   seeds: ["pool_authority"] + bump
   â”‚
   â–¼
7. Solana è¿è¡Œæ—¶éªŒè¯ï¼š
   "è¿™ä¸ª PDA ç¡®å®å±äº Meteora ç¨‹åºï¼Œå…è®¸è½¬è´¦"
   â”‚
   â–¼
8. äº¤æ˜“å®Œæˆï¼
```

**å…³é”®ç‚¹ï¼š**
- Poolã€Vault éƒ½æ˜¯ PDAï¼ˆå¯ä»¥è¢«ç¨‹åº"è®¡ç®—"å‡ºæ¥ï¼Œä¿è¯å”¯ä¸€æ€§ï¼‰
- Pool Authority æ˜¯ PDAï¼ˆå¯ä»¥"ç­¾å"æ§åˆ¶èµ„é‡‘ï¼Œä½†æ²¡æœ‰ç§é’¥ï¼‰
- åªæœ‰ Meteora ç¨‹åºèƒ½è®© Pool Authority "ç­¾å"

---

## æ€»ç»“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        PDA çŸ¥è¯†å›¾è°±                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. ä»€ä¹ˆæ˜¯ PDAï¼Ÿ                                            â”‚
â”‚     â†’ ç¨‹åºæ´¾ç”Ÿåœ°å€ï¼Œæ²¡æœ‰ç§é’¥ï¼Œåœ¨æ¤­åœ†æ›²çº¿å¤–                    â”‚
â”‚                                                             â”‚
â”‚  2. Seeds æ˜¯ä»€ä¹ˆï¼Ÿ                                          â”‚
â”‚     â†’ è®¡ç®— PDA çš„"åŸæ–™"ï¼Œå†³å®šåœ°å€çš„å”¯ä¸€æ€§                    â”‚
â”‚     â†’ è®¾è®¡è¦ç‚¹ï¼šä¿è¯åŒä¸€æ¦‚å¿µåªæœ‰å”¯ä¸€åœ°å€                     â”‚
â”‚                                                             â”‚
â”‚  3. Bump æ˜¯ä»€ä¹ˆï¼Ÿ                                           â”‚
â”‚     â†’ ç¡®ä¿åœ°å€åœ¨æ›²çº¿å¤–çš„"åç§»é‡"                             â”‚
â”‚     â†’ ä» 255 å¼€å§‹é€’å‡ï¼Œç›´åˆ°æ‰¾åˆ°æ›²çº¿å¤–çš„ç‚¹                    â”‚
â”‚                                                             â”‚
â”‚  4. find vs createï¼Ÿ                                        â”‚
â”‚     â†’ find: é“¾ä¸‹ç”¨ï¼Œä¼šè®¡ç®— bump                             â”‚
â”‚     â†’ create: é“¾ä¸Šç”¨ï¼Œç›´æ¥éªŒè¯ï¼ˆéœ€è¦å·²çŸ¥ bumpï¼‰              â”‚
â”‚                                                             â”‚
â”‚  5. ä¸ºä»€ä¹ˆç¨‹åºèƒ½"ç­¾å"ï¼Ÿ                                    â”‚
â”‚     â†’ ä¸‹ä¸€ç¯‡ï¼šCPI æ·±åº¦è§£æï¼ˆinvoke_signed çš„é»‘é­”æ³•ï¼‰         â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å›é¡¾ï¼šä½ å·²ç»ç”¨è¿‡çš„ PDA

ç°åœ¨å›å¤´çœ‹ï¼Œä½ ä¼šå‘ç° **PDA æ— å¤„ä¸åœ¨**ï¼š

| åœºæ™¯ | Seeds | ä½œç”¨ |
|------|-------|------|
| **ATA**ï¼ˆä¸€ç§ Token Accountï¼‰ | `[wallet, token_program, mint]` | è®©ä»»ä½•äººéƒ½èƒ½ç®—å‡ºâ€œé’±åŒ… + mintâ€å¯¹åº”çš„ ATA åœ°å€ï¼ˆå¯é¢„æµ‹ï¼‰ |
| **Meteora Pool** | `[pool, config, token_a, token_b]` | ä¿è¯åŒä¸€äº¤æ˜“å¯¹åªæœ‰å”¯ä¸€æ± å­ |
| **Meteora Vault** | `[token_vault, mint, pool]` | æ¯ä¸ªæ± å­æ¯ç§ä»£å¸ä¸€ä¸ªé‡‘åº“ |
| **Pool Authority** | `[pool_authority]` | ç¨‹åºæ§åˆ¶æ‰€æœ‰æ± å­èµ„é‡‘çš„"å°ç« " |

ç°åœ¨ä½ åº”è¯¥æ˜ç™½äº†ï¼š**PDA æ˜¯ Solana ç¨‹åºæ§åˆ¶èµ„äº§çš„æ ¸å¿ƒæœºåˆ¶**ã€‚

æ²¡æœ‰ PDAï¼Œç¨‹åºå°±æ— æ³•"æ‹¥æœ‰"ä»»ä½•ä¸œè¥¿ã€‚æœ‰äº† PDAï¼Œç¨‹åºå°±å¯ä»¥ï¼š
- âœ… åˆ›å»ºå¯é¢„æµ‹ã€å¯è®¡ç®—çš„è´¦æˆ·åœ°å€ï¼ˆATAï¼‰
- âœ… ä¿è¯åŒä¸€æ¦‚å¿µåªæœ‰å”¯ä¸€åœ°å€ï¼ˆPoolï¼‰
- âœ… åœ¨ CPI ä¸­"ç­¾å"è½¬ç§»èµ„é‡‘ï¼ˆPool Authorityï¼‰
- âœ… å®ç°å»ä¸­å¿ƒåŒ–çš„èµ„äº§ç®¡ç†

ä¸‹ä¸€ç¯‡ï¼Œæˆ‘ä»¬å°†æ·±å…¥ **CPIï¼ˆè·¨ç¨‹åºè°ƒç”¨ï¼‰**ï¼Œæ­ç§˜ `invoke_signed` æ˜¯å¦‚ä½•è®© PDA "ç­¾å" çš„ã€‚

Happy Coding! ğŸš€
